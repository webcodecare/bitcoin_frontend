import{j as e}from"./ui-vendor-mfLK6kkQ.js";import{r as v}from"./react-vendor--0RGCJ5T.js";import{d as R,j as w,n as b,o as C,p as N,k,T as H,s as E}from"./index-DMUxz8dE.js";import{A as S}from"./activity-Dkd0t9nU.js";import"./chart-vendor-CJvGuOij.js";function F({symbol:x="BTC",height:i=300,className:m}){const c=v.useRef(null),{data:n,isLoading:A}=R({queryKey:[`/api/public/chart/heatmap/${x}`],refetchInterval:6e4});if(v.useEffect(()=>{if(!c.current)return;c.current.innerHTML="";const s=document.createElement("canvas"),r=s.getContext("2d");if(!r)return;s.width=c.current.clientWidth||400,s.height=i,s.style.width="100%",s.style.height=`${i}px`,c.current.appendChild(s);const u=52,f=4,h=(s.width-80)/u,o=(s.height-120)/f,M=t=>t<-50?"#7f1d1d":t<-25?"#dc2626":t<-10?"#f97316":t<10?"#374151":t<25?"#059669":t<50?"#2563eb":"#7c3aed";r.fillStyle="hsl(var(--muted-foreground))",r.font="10px system-ui";for(let t=0;t<f;t++)for(let l=0;l<u;l++){let a;if(n&&n.length>0){const T=n[Math.min(l,n.length-1)];a=parseFloat(T.deviationPercent)}else a=Math.sin(l*.12)*30+Math.sin(t*.8)*15+(Math.random()*10-5);const g=20+l*h,y=40+t*o;r.fillStyle=M(a),r.fillRect(g,y,h-1,o-1),r.strokeStyle="hsl(var(--border))",r.lineWidth=.5,r.strokeRect(g,y,h-1,o-1)}r.fillStyle="hsl(var(--foreground))",r.font="12px system-ui",r.textAlign="right";for(let t=0;t<f;t++){const l=40+t*o+o/2;r.fillText(`${2021+t}`,15,l+4)}const p=s.height-30,j=[{color:"#dc2626",label:"<-50%"},{color:"#ef4444",label:"-25%"},{color:"#f97316",label:"0%"},{color:"#22c55e",label:"+25%"},{color:"#3b82f6",label:"+50%"},{color:"#8b5cf6",label:">50%"}];r.font="10px system-ui",r.textAlign="center",j.forEach((t,l)=>{const a=20+l*(s.width-40)/j.length;r.fillStyle=t.color,r.fillRect(a,p,20,15),r.fillStyle="hsl(var(--foreground))",r.fillText(t.label,a+10,p+25)})},[n,x,i]),A)return e.jsxs(w,{className:m,children:[e.jsxs(b,{children:[e.jsxs(C,{className:"flex items-center",children:[e.jsx(S,{className:"mr-2 h-5 w-5"}),"200-Week SMA Heatmap"]}),e.jsx(N,{children:"Loading heatmap data..."})]}),e.jsx(k,{children:e.jsx("div",{className:"flex items-center justify-center",style:{height:`${i}px`},children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})})]});const d=n&&n.length>0?parseFloat(n[0].deviationPercent):12.5;return e.jsxs(w,{className:m,children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(C,{className:"flex items-center",children:[e.jsx(S,{className:"mr-2 h-5 w-5"}),"200-Week SMA Heatmap"]}),e.jsx(N,{children:"Price deviation from 200-week moving average"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold",children:[d>0?"+":"",d.toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[d>0?e.jsx(H,{className:"w-3 h-3 mr-1"}):e.jsx(E,{className:"w-3 h-3 mr-1"}),"Current deviation"]})]})]})}),e.jsxs(k,{children:[e.jsx("div",{ref:c,className:"w-full",style:{height:`${i}px`}}),e.jsxs("div",{className:"mt-4 text-xs text-muted-foreground",children:[e.jsx("p",{children:"Green/Blue: Above 200-week SMA (potential profit-taking zones)"}),e.jsx("p",{children:"Red/Orange: Below 200-week SMA (potential accumulation zones)"})]})]})]})}export{F as default};
//# sourceMappingURL=HeatmapChart-D58HunIG.js.map
