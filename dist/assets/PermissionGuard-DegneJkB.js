import{j as e}from"./ui-vendor-mfLK6kkQ.js";import{u as h,j as v,n as f,S as u,o as A,q as w,p as P,k as x,B as g,g as p,L as y,ab as j,ad as S}from"./index-DMUxz8dE.js";const R={"users.view":{id:"users.view",name:"View Users",description:"View user profiles and information",category:"User Management"},"users.create":{id:"users.create",name:"Create Users",description:"Create new user accounts",category:"User Management"},"users.edit":{id:"users.edit",name:"Edit Users",description:"Modify user profiles and settings",category:"User Management"},"users.delete":{id:"users.delete",name:"Delete Users",description:"Delete user accounts",category:"User Management"},"users.manage_roles":{id:"users.manage_roles",name:"Manage User Roles",description:"Assign and modify user roles",category:"User Management"},"signals.view":{id:"signals.view",name:"View Signals",description:"View trading signals",category:"Trading"},"signals.create":{id:"signals.create",name:"Create Signals",description:"Create and send trading signals",category:"Trading"},"signals.manage":{id:"signals.manage",name:"Manage Signals",description:"Edit and delete trading signals",category:"Trading"},"trading.playground":{id:"trading.playground",name:"Trading Playground",description:"Access trading simulation",category:"Trading"},"analytics.basic":{id:"analytics.basic",name:"Basic Analytics",description:"View basic charts and analytics",category:"Analytics"},"analytics.advanced":{id:"analytics.advanced",name:"Advanced Analytics",description:"Access advanced analytics features",category:"Analytics"},"analytics.heatmap":{id:"analytics.heatmap",name:"Heatmap Analysis",description:"View 200-week heatmap analysis",category:"Analytics"},"analytics.cycle":{id:"analytics.cycle",name:"Cycle Forecasting",description:"Access cycle forecasting tools",category:"Analytics"},"analytics.portfolio":{id:"analytics.portfolio",name:"Portfolio Management",description:"Advanced portfolio analytics",category:"Analytics"},"alerts.email":{id:"alerts.email",name:"Email Alerts",description:"Send and receive email alerts",category:"Alerts"},"alerts.sms":{id:"alerts.sms",name:"SMS Alerts",description:"Send and receive SMS alerts",category:"Alerts"},"alerts.telegram":{id:"alerts.telegram",name:"Telegram Alerts",description:"Send and receive Telegram alerts",category:"Alerts"},"alerts.advanced":{id:"alerts.advanced",name:"Advanced Alerts",description:"Create complex alert conditions",category:"Alerts"},"alerts.manage":{id:"alerts.manage",name:"Manage Alerts",description:"Configure alert system",category:"Alerts"},"admin.dashboard":{id:"admin.dashboard",name:"Admin Dashboard",description:"Access admin dashboard",category:"Administration"},"admin.logs":{id:"admin.logs",name:"View Logs",description:"View system and audit logs",category:"Administration"},"admin.system":{id:"admin.system",name:"System Settings",description:"Modify system configuration",category:"Administration"},"admin.tickers":{id:"admin.tickers",name:"Manage Tickers",description:"Enable/disable trading pairs",category:"Administration"},"admin.webhooks":{id:"admin.webhooks",name:"Manage Webhooks",description:"Configure webhook integrations",category:"Administration"},"subscriptions.view":{id:"subscriptions.view",name:"View Subscriptions",description:"View subscription information",category:"Subscriptions"},"subscriptions.manage":{id:"subscriptions.manage",name:"Manage Subscriptions",description:"Modify subscription tiers",category:"Subscriptions"},"subscriptions.billing":{id:"subscriptions.billing",name:"Billing Management",description:"Access billing and payment info",category:"Subscriptions"},"api.basic":{id:"api.basic",name:"Basic API Access",description:"Access basic API endpoints",category:"API"},"api.advanced":{id:"api.advanced",name:"Advanced API Access",description:"Access advanced API features",category:"API"},"api.admin":{id:"api.admin",name:"Admin API Access",description:"Access administrative API endpoints",category:"API"}},b={user:{id:"user",name:"User",description:"Standard user with basic features",isDefault:!0,permissions:["signals.view","analytics.basic","alerts.email","subscriptions.view","api.basic"]},basic_user:{id:"basic_user",name:"Basic User",description:"Basic subscription with enhanced features",permissions:["signals.view","analytics.basic","analytics.heatmap","trading.playground","alerts.email","alerts.sms","subscriptions.view","api.basic"]},premium_user:{id:"premium_user",name:"Premium User",description:"Premium subscription with advanced features",permissions:["signals.view","analytics.basic","analytics.advanced","analytics.heatmap","analytics.cycle","analytics.portfolio","trading.playground","alerts.email","alerts.sms","alerts.telegram","alerts.advanced","subscriptions.view","subscriptions.billing","api.basic","api.advanced"]},pro_user:{id:"pro_user",name:"Pro User",description:"Pro subscription with all user features",permissions:["signals.view","analytics.basic","analytics.advanced","analytics.heatmap","analytics.cycle","analytics.portfolio","trading.playground","alerts.email","alerts.sms","alerts.telegram","alerts.advanced","subscriptions.view","subscriptions.billing","api.basic","api.advanced"]},admin:{id:"admin",name:"Administrator",description:"System administrator with management privileges",permissions:["signals.view","analytics.basic","analytics.advanced","analytics.heatmap","analytics.cycle","analytics.portfolio","trading.playground","alerts.email","alerts.sms","alerts.telegram","alerts.advanced","subscriptions.view","subscriptions.billing","api.basic","api.advanced","users.view","users.create","users.edit","users.delete","users.manage_roles","signals.create","signals.manage","alerts.manage","admin.dashboard","admin.logs","admin.system","admin.tickers","admin.webhooks","subscriptions.manage","api.admin"]},superuser:{id:"superuser",name:"Super User",description:"Full system access with all permissions",permissions:["users.view","users.create","users.edit","users.delete","users.manage_roles","signals.view","signals.create","signals.manage","trading.playground","analytics.basic","analytics.advanced","analytics.heatmap","analytics.cycle","analytics.portfolio","alerts.email","alerts.sms","alerts.telegram","alerts.advanced","alerts.manage","admin.dashboard","admin.logs","admin.system","admin.tickers","admin.webhooks","subscriptions.view","subscriptions.manage","subscriptions.billing","api.basic","api.advanced","api.admin"]}};class d{static hasPermission(s,a){if(!s)return!1;const i=this.getRolePermissions(s.role),n=this.getSubscriptionPermissions(s.subscriptionTier);return[...i,...n].includes(a)}static hasAnyPermission(s,a){return s?a.some(i=>this.hasPermission(s,i)):!1}static hasAllPermissions(s,a){return s?a.every(i=>this.hasPermission(s,i)):!1}static getRolePermissions(s){const a=b[s];return a?a.permissions:b.user.permissions}static getSubscriptionPermissions(s){const i={free:"user",basic:"basic_user",premium:"premium_user",pro:"pro_user"}[s]||"user";return this.getRolePermissions(i)}static canAccessFeature(s,a){const n={heatmapAnalysis:"analytics.heatmap",cycleForecasting:"analytics.cycle",advancedAnalytics:"analytics.advanced",tradingPlayground:"trading.playground",advancedAlerts:"alerts.advanced",portfolioManagement:"analytics.portfolio",smsAlerts:"alerts.sms",telegramAlerts:"alerts.telegram"}[a];return n?this.hasPermission(s,n):!0}static getUserPermissions(s){if(!s)return[];const a=this.getRolePermissions(s.role),i=this.getSubscriptionPermissions(s.subscriptionTier);return[...new Set([...a,...i])]}static canAccessRoute(s,a){const n={"/admin":["admin.dashboard"],"/admin/users":["users.view"],"/admin/signals":["signals.manage"],"/admin/tickers":["admin.tickers"],"/admin/alerts":["alerts.manage"],"/admin/logs":["admin.logs"],"/admin/analytics":["analytics.advanced"],"/trading-playground":["trading.playground"],"/advanced-portfolio":["analytics.portfolio"],"/advanced-alerts":["alerts.advanced"]}[a];return n?this.hasAnyPermission(s,n):!0}}function M({children:c,permission:s,permissions:a=[],requireAll:i=!1,fallback:n,showUpgrade:m=!0,feature:l}){const{user:r}=h();let t=!1,o="";return l?(t=d.canAccessFeature(r,l),o=`Feature '${l}' requires additional permissions`):s?(t=d.hasPermission(r,s),o=`This action requires '${s}' permission`):a.length>0?(t=i?d.hasAllPermissions(r,a):d.hasAnyPermission(r,a),o=`This action requires ${i?"all":"one"} of these permissions: ${a.join(", ")}`):t=!0,t?e.jsx(e.Fragment,{children:c}):n?e.jsx(e.Fragment,{children:n}):m?e.jsxs(v,{className:"border-2 border-dashed border-destructive/20 bg-gradient-to-br from-destructive/5 to-orange/5",children:[e.jsxs(f,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:e.jsx(u,{className:"h-8 w-8 text-destructive"})}),e.jsxs(A,{className:"flex items-center justify-center gap-2",children:[e.jsx(w,{className:"h-5 w-5 text-destructive"}),"Access Restricted"]}),e.jsx(P,{children:o})]}),e.jsxs(x,{className:"text-center space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Current Role:"}),e.jsx(g,{variant:"outline",children:(r==null?void 0:r.role)||"Guest"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Subscription:"}),e.jsx(g,{variant:"outline",children:(r==null?void 0:r.subscriptionTier)||"Free"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{asChild:!0,className:"w-full",children:e.jsxs(y,{href:"/pricing",children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Upgrade Subscription",e.jsx(j,{className:"h-4 w-4 ml-2"})]})}),e.jsx(p,{variant:"outline",asChild:!0,className:"w-full",children:e.jsxs(y,{href:"/contact",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Request Access"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contact support if you believe you should have access to this feature"})]})]}):null}function U({children:c,fallback:s}){return e.jsx(M,{permission:"admin.dashboard",fallback:s,children:c})}export{U as A,R as P,b as R,d as a,M as b};
//# sourceMappingURL=PermissionGuard-DegneJkB.js.map
