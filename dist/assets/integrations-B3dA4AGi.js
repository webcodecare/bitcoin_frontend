import{j as e}from"./ui-vendor-mfLK6kkQ.js";import{r as g}from"./react-vendor--0RGCJ5T.js";import{b as q,d as A,e as P,j as r,n as x,k as n,o as v,p as f,g as u,B as h,Q as T,D as M,E as R,F as B,G as H,H as O,I as p,J as N,K as z,w as Q,Z,f as E,aq as $}from"./index-DMUxz8dE.js";import{S as G,a as J}from"./Sidebar-CWwWAgFd.js";import{S as V}from"./switch-6PBAG7U5.js";import{T as _,a as W,b as y,c as b}from"./tabs-CFs29E2A.js";import{T as X}from"./test-tube-XhA9jODQ.js";import{A as l}from"./activity-Dkd0t9nU.js";import{S as Y}from"./save-BnNngDY3.js";import{S as ee}from"./smartphone-BAgSRykf.js";import{D as se}from"./dollar-sign-BsbVyGJM.js";import"./chart-vendor-CJvGuOij.js";import"./message-square-DEryHNXU.js";import"./file-text-CVGYDGjh.js";import"./index-BBVDPgwe.js";function ve(){const[t,D]=g.useState(null),[F,o]=g.useState(!1),[c,d]=g.useState({apiKey:"",apiSecret:"",endpoint:"",isActive:!1,configuration:{}}),{toast:m}=q(),{data:i=[],isLoading:K}=A({queryKey:["/api/admin/integrations"]}),{data:w=[]}=A({queryKey:["/api/admin/integrations/usage"]}),j=P({mutationFn:async({id:s,data:a})=>(await E("PUT",`/api/admin/integrations/${s}`,a)).json(),onSuccess:()=>{$.invalidateQueries({queryKey:["/api/admin/integrations"]}),o(!1),m({title:"Integration Updated",description:"API integration has been updated successfully."})},onError:s=>{m({title:"Update Failed",description:s.message||"Failed to update integration",variant:"destructive"})}}),C=P({mutationFn:async s=>(await E("POST",`/api/admin/integrations/${s}/test`)).json(),onSuccess:s=>{m({title:"Test Successful",description:s.message||"Integration test completed successfully."})},onError:s=>{m({title:"Test Failed",description:s.message||"Integration test failed",variant:"destructive"})}}),S=s=>{switch(s){case"tradingview":return e.jsx(Z,{className:"h-5 w-5 text-blue-500"});case"binance":return e.jsx(l,{className:"h-5 w-5 text-yellow-500"});case"coincap":return e.jsx(l,{className:"h-5 w-5 text-green-500"});case"stripe":return e.jsx(se,{className:"h-5 w-5 text-purple-500"});case"onesignal":return e.jsx(Q,{className:"h-5 w-5 text-red-500"});case"twilio":return e.jsx(ee,{className:"h-5 w-5 text-blue-600"});default:return e.jsx(T,{className:"h-5 w-5 text-gray-500"})}},I=s=>s.isActive?s.errorCount>0?e.jsx(h,{variant:"destructive",children:"Errors"}):e.jsx(h,{variant:"default",children:"Active"}):e.jsx(h,{variant:"secondary",children:"Inactive"}),L=s=>{D(s),d({apiKey:s.apiKey,apiSecret:s.apiSecret||"",endpoint:s.endpoint,isActive:s.isActive,configuration:s.configuration||{}}),o(!0)},U=()=>{t&&j.mutate({id:t.id,data:c})},k=s=>s.length<=8?s:s.slice(0,4)+"•".repeat(s.length-8)+s.slice(-4);return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"flex",children:[e.jsx(G,{}),e.jsxs("div",{className:"ml-0 lg:ml-64 flex-1",children:[e.jsx("header",{className:"bg-card border-b border-border p-4 lg:p-6",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold",children:"3rd Party API Integrations"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage API keys, endpoints, and usage logs for external services"})]})})}),e.jsxs("div",{className:"p-4 lg:p-6 space-y-6",children:[e.jsxs(_,{defaultValue:"integrations",className:"space-y-4",children:[e.jsxs(W,{children:[e.jsx(y,{value:"integrations",children:"API Integrations"}),e.jsx(y,{value:"usage",children:"Usage Logs"}),e.jsx(y,{value:"monitoring",children:"Monitoring"})]}),e.jsx(b,{value:"integrations",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:K?Array.from({length:6}).map((s,a)=>e.jsxs(r,{className:"animate-pulse",children:[e.jsxs(x,{children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})})]},a)):i.map(s=>e.jsxs(r,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[S(s.service),e.jsxs("div",{children:[e.jsx(v,{className:"text-lg",children:s.name}),e.jsx(f,{className:"capitalize",children:s.service})]})]}),I(s)]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"API Key"}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:k(s.apiKey)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Endpoint"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.endpoint})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Usage Count"}),e.jsx("p",{className:"text-muted-foreground",children:s.usageCount.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Error Count"}),e.jsx("p",{className:"text-muted-foreground text-red-600",children:s.errorCount})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>L(s),className:"flex-1",children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>C.mutate(s.id),disabled:C.isPending,className:"flex-1",children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Test"]})]})]})})]},s.id))})}),e.jsx(b,{value:"usage",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(x,{children:[e.jsx(v,{children:"API Usage Logs"}),e.jsx(f,{children:"Recent API calls and their response status"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-2",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(l,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No usage logs available"})]}):w.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(h,{variant:s.statusCode>=200&&s.statusCode<300?"default":"destructive",children:s.statusCode}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.endpoint}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.method," • ",new Date(s.timestamp).toLocaleString()]}),s.errorMessage&&e.jsx("p",{className:"text-sm text-red-600",children:s.errorMessage})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-medium",children:[s.responseTime,"ms"]})})]},s.id))})})]})}),e.jsxs(b,{value:"monitoring",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total API Calls"}),e.jsx("p",{className:"text-2xl font-bold",children:i.reduce((s,a)=>s+a.usageCount,0).toLocaleString()})]}),e.jsx(l,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Integrations"}),e.jsx("p",{className:"text-2xl font-bold",children:i.filter(s=>s.isActive).length})]}),e.jsx(T,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Errors"}),e.jsx("p",{className:"text-2xl font-bold",children:i.reduce((s,a)=>s+a.errorCount,0)})]}),e.jsx(l,{className:"h-8 w-8 text-red-500"})]})})}),e.jsx(r,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[i.length>0?((i.reduce((s,a)=>s+a.usageCount,0)-i.reduce((s,a)=>s+a.errorCount,0))/i.reduce((s,a)=>s+a.usageCount,0)*100).toFixed(1):0,"%"]})]}),e.jsx(l,{className:"h-8 w-8 text-green-500"})]})})})]}),e.jsxs(r,{children:[e.jsxs(x,{children:[e.jsx(v,{children:"Integration Health Status"}),e.jsx(f,{children:"Real-time status of all API integrations"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-3",children:i.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[S(s.service),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last used: ",s.lastUsed?new Date(s.lastUsed).toRelativeTimeString():"Never"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"font-medium",children:[s.usageCount," calls"]}),e.jsxs("p",{className:"text-muted-foreground",children:[s.errorCount," errors"]})]}),I(s)]})]},s.id))})})]})]})]}),e.jsx(M,{open:F,onOpenChange:o,children:e.jsxs(R,{className:"max-w-2xl",children:[e.jsxs(B,{children:[e.jsxs(H,{children:["Edit Integration: ",t==null?void 0:t.name]}),e.jsxs(O,{children:["Update API configuration for ",t==null?void 0:t.service]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"api-key",children:"API Key"}),e.jsx(N,{id:"api-key",type:"password",value:c.apiKey,onChange:s=>d(a=>({...a,apiKey:s.target.value})),placeholder:"Enter API key"})]}),(t==null?void 0:t.service)==="stripe"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"api-secret",children:"API Secret"}),e.jsx(N,{id:"api-secret",type:"password",value:c.apiSecret,onChange:s=>d(a=>({...a,apiSecret:s.target.value})),placeholder:"Enter API secret"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"endpoint",children:"Endpoint URL"}),e.jsx(N,{id:"endpoint",value:c.endpoint,onChange:s=>d(a=>({...a,endpoint:s.target.value})),placeholder:"https://api.example.com/v1"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{checked:c.isActive,onCheckedChange:s=>d(a=>({...a,isActive:s}))}),e.jsx(p,{children:"Enable Integration"})]})]})}),e.jsxs(z,{children:[e.jsx(u,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(u,{onClick:U,disabled:j.isPending,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),j.isPending?"Saving...":"Save Changes"]})]})]})})]})]})]})})}export{ve as default};
//# sourceMappingURL=integrations-B3dA4AGi.js.map
