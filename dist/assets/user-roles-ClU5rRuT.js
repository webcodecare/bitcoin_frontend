import{j as e}from"./ui-vendor-mfLK6kkQ.js";import{r as h}from"./react-vendor--0RGCJ5T.js";import{y as c,j as t,b as _,d as R,e as w,B as d,S as q,n as m,o as x,U as $,k as u,C as k,Q as G,J as f,D as W,z as X,g,E as Y,F as Z,G as ee,H as se,I as N,K as ae,p as E,aq as S}from"./index-DMUxz8dE.js";import{T as re,a as ie,b as A,c as C}from"./tabs-CFs29E2A.js";import{S as T,a as U,b as F,c as D,d as o}from"./select-Brp6yn3A.js";import{T as te,a as ne,b as P,c as j,d as le,e as p}from"./table-C5Wewpyf.js";import{A as ce,b as v}from"./PermissionGuard-DegneJkB.js";import{S as de,U as oe,a as me}from"./Sidebar-CWwWAgFd.js";import{T as xe}from"./TopBar-Bv1iDUNo.js";import{S as ue}from"./search-DB-Wf2A-.js";import{U as he}from"./user-plus-DKFAIhv8.js";import{K as je}from"./key-L9mfzYML.js";import"./chart-vendor-CJvGuOij.js";import"./index-BdQq_4o_.js";import"./index-BBVDPgwe.js";import"./chevron-down-BE_ioXd1.js";import"./activity-Dkd0t9nU.js";import"./dollar-sign-BsbVyGJM.js";import"./message-square-DEryHNXU.js";import"./file-text-CVGYDGjh.js";const pe=()=>e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"h-8 w-48"}),e.jsx(c,{className:"h-4 w-96"})]}),e.jsx(c,{className:"h-10 w-32"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:Array.from({length:4}).map((r,i)=>e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"h-4 w-24"}),e.jsx(c,{className:"h-8 w-16"})]})},i))}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"h-6 w-32"}),e.jsx("div",{className:"space-y-2",children:Array.from({length:6}).map((r,i)=>e.jsx(c,{className:"h-12 w-full"},i))})]})})]})});function fe({children:r,fallback:i=e.jsx(pe,{})}){return e.jsx(h.Suspense,{fallback:i,children:r})}function ge(){const{toast:r}=_(),[i,M]=h.useState(""),[y,K]=h.useState(""),[H,L]=h.useState(!1);h.useState(!1),h.useState(null);const{data:n=[],isLoading:Ne}=R({queryKey:["/api/admin/users",{role:"admin,superuser"}],queryFn:async()=>{const s=await fetch("/api/admin/users?roles=admin,superuser");if(!s.ok)throw new Error("Failed to fetch admin users");return s.json()}}),{data:O=[]}=R({queryKey:["/api/admin/roles"],queryFn:async()=>[{id:"admin",name:"Administrator",description:"Full system administration access",permissions:["users.view","users.create","users.edit","users.delete","admin.dashboard","signals.manage"],userCount:n.filter(s=>s.role==="admin").length},{id:"superuser",name:"Super Administrator",description:"Complete system control and access",permissions:["*"],userCount:n.filter(s=>s.role==="superuser").length}]}),b=w({mutationFn:async s=>{const a=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to create admin user");return a.json()},onSuccess:()=>{S.invalidateQueries({queryKey:["/api/admin/users"]}),L(!1),r({title:"Success",description:"Admin user created successfully"})},onError:s=>{r({title:"Error",description:s.message||"Failed to create admin user",variant:"destructive"})}}),B=w({mutationFn:async({userId:s,role:a})=>{const l=await fetch(`/api/admin/users/${s}/role`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:a})});if(!l.ok)throw new Error("Failed to update user role");return l.json()},onSuccess:()=>{S.invalidateQueries({queryKey:["/api/admin/users"]}),r({title:"Success",description:"User role updated successfully"})},onError:s=>{r({title:"Error",description:s.message||"Failed to update user role",variant:"destructive"})}}),I=w({mutationFn:async({userId:s,isActive:a})=>{const l=await fetch(`/api/admin/users/${s}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:a})});if(!l.ok)throw new Error("Failed to update user status");return l.json()},onSuccess:()=>{S.invalidateQueries({queryKey:["/api/admin/users"]}),r({title:"Success",description:"User status updated successfully"})}}),J=n.filter(s=>{const a=s.email.toLowerCase().includes(i.toLowerCase())||`${s.firstName} ${s.lastName}`.toLowerCase().includes(i.toLowerCase()),l=!y||s.role===y;return a&&l}),Q=s=>{const a={email:s.get("email"),firstName:s.get("firstName"),lastName:s.get("lastName"),role:s.get("role"),subscriptionTier:"pro",isActive:!0};b.mutate(a)},z=(s,a)=>{B.mutate({userId:s,role:a})},V=(s,a)=>{I.mutate({userId:s,isActive:!a})};return e.jsx(ce,{children:e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(de,{}),e.jsxs("div",{className:"lg:pl-72",children:[e.jsx(xe,{}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage administrator accounts and role-based permissions"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(d,{variant:"outline",className:"bg-blue-500/10 text-blue-600 border-blue-200",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"Role-Based Access"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(t,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Total Admins"}),e.jsx($,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active admin accounts"})]})]}),e.jsxs(t,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Administrators"}),e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.filter(s=>s.role==="admin").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Standard admin role"})]})]}),e.jsxs(t,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Super Admins"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.filter(s=>s.role==="superuser").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Full system access"})]})]}),e.jsxs(t,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(u,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.filter(s=>s.isActive).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]})]}),e.jsxs(re,{defaultValue:"users",className:"space-y-4",children:[e.jsxs(ie,{children:[e.jsx(A,{value:"users",children:"Admin Users"}),e.jsx(A,{value:"roles",children:"Role Management"}),e.jsx(A,{value:"permissions",children:"Permission Matrix"})]}),e.jsxs(C,{value:"users",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(f,{placeholder:"Search admin users...",value:i,onChange:s=>M(s.target.value),className:"pl-9 w-64"})]}),e.jsxs(T,{value:y,onValueChange:K,children:[e.jsx(U,{className:"w-48",children:e.jsx(F,{placeholder:"Filter by role"})}),e.jsxs(D,{children:[e.jsx(o,{value:"all",children:"All Roles"}),e.jsx(o,{value:"admin",children:"Administrator"}),e.jsx(o,{value:"superuser",children:"Super Admin"})]})]})]}),e.jsx(v,{permission:"users.create",children:e.jsxs(W,{open:H,onOpenChange:L,children:[e.jsx(X,{asChild:!0,children:e.jsxs(g,{children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Add Admin User"]})}),e.jsxs(Y,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Create Admin User"}),e.jsx(se,{children:"Add a new administrator to the system with role-based permissions."})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),Q(new FormData(s.currentTarget))},children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"firstName",children:"First Name"}),e.jsx(f,{name:"firstName",placeholder:"John",required:!0})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"lastName",children:"Last Name"}),e.jsx(f,{name:"lastName",placeholder:"Doe",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"email",children:"Email"}),e.jsx(f,{name:"email",type:"email",placeholder:"admin@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"role",children:"Role"}),e.jsxs(T,{name:"role",required:!0,children:[e.jsx(U,{children:e.jsx(F,{placeholder:"Select role"})}),e.jsxs(D,{children:[e.jsx(o,{value:"admin",children:"Administrator"}),e.jsx(o,{value:"superuser",children:"Super Administrator"})]})]})]})]}),e.jsx(ae,{children:e.jsx(g,{type:"submit",disabled:b.isPending,children:b.isPending?"Creating...":"Create Admin User"})})]})]})]})})]}),e.jsx(t,{children:e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(P,{children:[e.jsx(j,{children:"User"}),e.jsx(j,{children:"Role"}),e.jsx(j,{children:"Status"}),e.jsx(j,{children:"Last Login"}),e.jsx(j,{children:"Actions"})]})}),e.jsx(le,{children:J.map(s=>e.jsxs(P,{children:[e.jsx(p,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})}),e.jsx(p,{children:e.jsx(v,{permission:"users.manage_roles",fallback:e.jsx(d,{variant:s.role==="superuser"?"default":"secondary",children:s.role==="superuser"?"Super Admin":"Administrator"}),children:e.jsxs(T,{value:s.role,onValueChange:a=>z(s.id,a),children:[e.jsx(U,{className:"w-32",children:e.jsx(F,{})}),e.jsxs(D,{children:[e.jsx(o,{value:"admin",children:"Administrator"}),e.jsx(o,{value:"superuser",children:"Super Admin"})]})]})})}),e.jsx(p,{children:e.jsx(d,{variant:s.isActive?"default":"secondary",children:s.isActive?"Active":"Inactive"})}),e.jsx(p,{children:s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{permission:"users.edit",children:e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(me,{className:"h-3 w-3"})})}),e.jsx(v,{permission:"users.manage_roles",children:e.jsx(g,{variant:"outline",size:"sm",onClick:()=>V(s.id,s.isActive),children:s.isActive?"Disable":"Enable"})})]})})]},s.id))})]})})]}),e.jsx(C,{value:"roles",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:O.map(s=>e.jsxs(t,{children:[e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[s.id==="superuser"?e.jsx(k,{className:"h-5 w-5"}):e.jsx(q,{className:"h-5 w-5"}),s.name]}),e.jsxs(d,{variant:"outline",children:[s.userCount," users"]})]}),e.jsx(E,{children:s.description})]}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Permissions:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.permissions.includes("*")?e.jsx(d,{variant:"default",className:"text-xs",children:"All Permissions"}):s.permissions.slice(0,4).map(a=>e.jsx(d,{variant:"secondary",className:"text-xs",children:a},a)),s.permissions.length>4&&!s.permissions.includes("*")&&e.jsxs(d,{variant:"outline",className:"text-xs",children:["+",s.permissions.length-4," more"]})]})]})})]},s.id))})}),e.jsx(C,{value:"permissions",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(m,{children:[e.jsx(x,{children:"Admin Permission Matrix"}),e.jsx(E,{children:"Compare permissions across different admin roles"})]}),e.jsx(u,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(je,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Detailed permission matrix coming soon..."}),e.jsx("p",{className:"text-xs mt-2",children:"This will show a comprehensive comparison of admin role permissions"})]})})]})})]})]})]})]})})}function Oe(){return e.jsx(fe,{children:e.jsx(ge,{})})}export{Oe as default};
//# sourceMappingURL=user-roles-ClU5rRuT.js.map
