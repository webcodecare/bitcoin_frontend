import{j as e}from"./ui-vendor-mfLK6kkQ.js";import{r as V}from"./react-vendor--0RGCJ5T.js";import{b as z,a as J,a0 as W,d as L,e as A,j as m,k as h,w as u,g as v,B as b,n as F,o as R,p as D,I as j,J as X,O as Z,s as ee,T as se,u as ae}from"./index-DMUxz8dE.js";import{S as M}from"./Sidebar-CWwWAgFd.js";import{S as te}from"./switch-6PBAG7U5.js";import{S as k,a as C,b as S,c as T,d as c}from"./select-Brp6yn3A.js";import{T as re,a as le,b as P,c as E}from"./tabs-CFs29E2A.js";import{S as ie}from"./smartphone-BAgSRykf.js";import{M as I}from"./message-square-DEryHNXU.js";import{A as ne}from"./activity-Dkd0t9nU.js";import{S as ce}from"./SubscriptionGuard-BSUQsUEM.js";import"./chart-vendor-CJvGuOij.js";import"./dollar-sign-BsbVyGJM.js";import"./file-text-CVGYDGjh.js";import"./index-BBVDPgwe.js";import"./index-BdQq_4o_.js";import"./chevron-down-BE_ioXd1.js";function de(){const[r,d]=V.useState({type:"price",ticker:"BTCUSDT",condition:"above",value:7e4,channels:["email"]}),{toast:o}=z(),p=J(),l=W.get(),g=async(s,a,x)=>{if(!l)throw o({title:"Authentication Required",description:"Please log in to create alerts",variant:"destructive"}),new Error("Please log in to create alerts");try{const t=await fetch(a,{method:s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:x?JSON.stringify(x):void 0});if(!t.ok){let i;try{i=await t.json()}catch{i={message:"Unknown error occurred"}}let n="Failed to create alert. Please try again.";throw t.status===400&&i.code==="INVALID_USER_ID"?n="Your session has expired. Please log in again to continue.":t.status===401?n="Please log in again to continue":t.status===403?n="You don't have permission to perform this action":t.status===409?n="An alert with these settings already exists":t.status===422?i.code==="VALIDATION_ERROR"?n="Please check your alert settings. Some information may be invalid.":n="Please check your alert settings and try again":t.status===500&&i.code==="DATABASE_ERROR"?n="Database connection issue. Please try again in a moment.":i.message&&(n=i.message),o({title:"Alert Creation Failed",description:n,variant:"destructive"}),new Error(n)}return t.json()}catch(t){if(t instanceof Error)throw t.message.includes("log in")||o({title:"Network Error",description:t.message||"Please check your connection and try again.",variant:"destructive"}),t;const i="Network error. Please check your connection and try again.";throw o({title:"Connection Error",description:i,variant:"destructive"}),new Error(i)}},{data:f=[],isLoading:K,error:y}=L({queryKey:["/api/alerts",l],queryFn:()=>g("GET","/api/alerts"),enabled:!!l,retry:1,staleTime:3e4}),{data:Q=[],isLoading:O,error:N}=L({queryKey:["/api/tickers",l],queryFn:()=>g("GET","/api/tickers"),enabled:!!l,retry:1,staleTime:6e4}),q=K||O,w=A({mutationFn:s=>{const a={...s,value:s.value.toString()};return g("POST","/api/alerts",a)},onSuccess:()=>{p.invalidateQueries({queryKey:["/api/alerts",l]}),o({title:"Alert Created",description:"Your alert has been set up successfully"}),d({type:"price",ticker:"BTCUSDT",condition:"above",value:7e4,channels:["email"]})},onError:s=>{o({title:"Error",description:s.message||"Failed to create alert",variant:"destructive"})}}),U=A({mutationFn:({id:s,enabled:a})=>g("PATCH",`/api/alerts/${s}`,{enabled:a}),onSuccess:()=>{p.invalidateQueries({queryKey:["/api/alerts",l]})}}),_=A({mutationFn:s=>g("DELETE",`/api/alerts/${s}`),onSuccess:()=>{p.invalidateQueries({queryKey:["/api/alerts",l]}),o({title:"Alert Deleted",description:"Alert has been removed"})}}),G=async()=>{if(!r.ticker||!r.value||r.channels.length===0){o({title:"Invalid Alert",description:"Please fill in all required fields",variant:"destructive"});return}await w.mutateAsync(r)},H=s=>{d(a=>({...a,channels:a.channels.includes(s)?a.channels.filter(x=>x!==s):[...a.channels,s]}))},Y=s=>{switch(s){case"price":return e.jsx(se,{className:"h-4 w-4"});case"technical":return e.jsx(ne,{className:"h-4 w-4"});case"volume":return e.jsx(ee,{className:"h-4 w-4"});case"news":return e.jsx(I,{className:"h-4 w-4"});case"whale":return e.jsx(u,{className:"h-4 w-4"});default:return e.jsx(u,{className:"h-4 w-4"})}},$=s=>{switch(s){case"price":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"technical":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"volume":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200";case"news":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200";case"whale":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};return l?q?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-64 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-96"})]}),e.jsx("div",{className:"h-6 bg-muted rounded w-24"})]}),e.jsx("div",{className:"grid gap-4",children:[1,2,3].map(s=>e.jsx(m,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/4"})]})})},s))})]}):y||N?e.jsx("div",{className:"space-y-6",children:e.jsx(m,{children:e.jsxs(h,{className:"p-8 text-center",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Unable to Load Alerts"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:(y==null?void 0:y.message)||(N==null?void 0:N.message)||"There was an error loading the alert system."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(v,{onClick:()=>{p.invalidateQueries({queryKey:["/api/alerts",l]}),p.invalidateQueries({queryKey:["/api/tickers",l]})},children:"Retry"}),e.jsx(v,{variant:"outline",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Advanced Alert System"}),e.jsx("p",{className:"text-muted-foreground",children:"Set up intelligent alerts for price movements, technical indicators, and market events"})]}),e.jsxs(b,{variant:"secondary",className:"text-sm",children:[f.length," Active Alerts"]})]}),e.jsxs(re,{defaultValue:"create",className:"w-full",children:[e.jsxs(le,{className:"grid w-full grid-cols-3",children:[e.jsx(P,{value:"create",children:"Create Alert"}),e.jsx(P,{value:"active",children:"Active Alerts"}),e.jsx(P,{value:"history",children:"Alert History"})]}),e.jsx(E,{value:"create",className:"space-y-4",children:e.jsxs(m,{children:[e.jsxs(F,{children:[e.jsx(R,{children:"Create New Alert"}),e.jsx(D,{children:"Set up custom alerts for price movements, technical indicators, and market events"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"alert-type",children:"Alert Type"}),e.jsxs(k,{value:r.type,onValueChange:s=>d(a=>({...a,type:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select alert type"})}),e.jsxs(T,{children:[e.jsx(c,{value:"price",children:"Price Alert"}),e.jsx(c,{value:"technical",children:"Technical Indicator"}),e.jsx(c,{value:"volume",children:"Volume Spike"}),e.jsx(c,{value:"news",children:"News Event"}),e.jsx(c,{value:"whale",children:"Whale Movement"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"ticker",children:"Cryptocurrency"}),e.jsxs(k,{value:r.ticker,onValueChange:s=>d(a=>({...a,ticker:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select ticker"})}),e.jsx(T,{children:Q.map(s=>e.jsxs(c,{value:s.symbol,children:[s.symbol," - ",s.name]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"condition",children:"Condition"}),e.jsxs(k,{value:r.condition,onValueChange:s=>d(a=>({...a,condition:s})),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select condition"})}),e.jsxs(T,{children:[e.jsx(c,{value:"above",children:"Price Above"}),e.jsx(c,{value:"below",children:"Price Below"}),e.jsx(c,{value:"crosses_above",children:"Crosses Above"}),e.jsx(c,{value:"crosses_below",children:"Crosses Below"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"value",children:"Value"}),e.jsx(X,{id:"value",type:"number",value:r.value,onChange:s=>d(a=>({...a,value:parseFloat(s.target.value)||0})),placeholder:"Enter threshold value"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Notification Channels"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"email",label:"Email",icon:Z},{key:"sms",label:"SMS",icon:ie},{key:"push",label:"Push",icon:u},{key:"telegram",label:"Telegram",icon:I}].map(({key:s,label:a,icon:x})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:s,checked:r.channels.includes(s),onChange:()=>H(s),className:"rounded border-gray-300"}),e.jsxs(j,{htmlFor:s,className:"flex items-center space-x-1 cursor-pointer",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx("span",{children:a})]})]},s))})]}),e.jsx(v,{onClick:G,disabled:w.isPending,className:"w-full",children:w.isPending?"Creating...":"Create Alert"})]})]})}),e.jsx(E,{value:"active",className:"space-y-4",children:q?e.jsx("div",{className:"text-center py-8",children:"Loading alerts..."}):f.length===0?e.jsx(m,{children:e.jsxs(h,{className:"text-center py-8",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Active Alerts"}),e.jsx("p",{className:"text-muted-foreground",children:"Create your first alert to get started"})]})}):e.jsx("div",{className:"grid gap-4",children:f.map(s=>e.jsx(m,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[Y(s.type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold",children:s.ticker}),e.jsx(b,{className:$(s.type),children:s.type})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.condition," ",s.value]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{checked:s.enabled,onCheckedChange:a=>U.mutate({id:s.id,enabled:a})}),e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>_.mutate(s.id),children:"Delete"})]})]})})},s.id))})}),e.jsx(E,{value:"history",className:"space-y-4",children:e.jsxs(m,{children:[e.jsxs(F,{children:[e.jsx(R,{children:"Alert History"}),e.jsx(D,{children:"View your triggered alerts and notification history"})]}),e.jsx(h,{children:e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Alert history will be displayed here"})})]})})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsx(m,{children:e.jsxs(h,{className:"p-8 text-center",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Authentication Required"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Please log in to access the alert system."}),e.jsx(v,{onClick:()=>window.location.href="/login",children:"Go to Login"})]})})})}function B(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-64 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-96"})]}),e.jsx("div",{className:"h-6 bg-muted rounded w-24"})]}),e.jsx("div",{className:"grid gap-4",children:[1,2,3].map(r=>e.jsx(m,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/4"})]})})},r))})]})}function Se(){const{user:r,isLoading:d}=ae();return d?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"flex",children:[e.jsx(M,{}),e.jsxs("div",{className:"ml-0 md:ml-64 flex-1",children:[e.jsx("header",{className:"bg-card border-b border-border p-3 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx(u,{className:"h-5 w-5 sm:h-6 sm:w-6"}),e.jsx("h1",{className:"text-lg sm:text-2xl font-bold",children:"Advanced Alert System"})]}),e.jsx(b,{variant:"outline",className:"text-emerald-400 text-xs sm:text-sm",children:"Multi-Channel Alerts"})]})}),e.jsx("div",{className:"p-3 sm:p-6",children:e.jsx(B,{})})]})]})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"flex",children:[e.jsx(M,{}),e.jsxs("div",{className:"ml-0 md:ml-64 flex-1",children:[e.jsx("header",{className:"bg-card border-b border-border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(u,{className:"h-6 w-6 text-[#4A90A4]"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Advanced Alert System"})]}),e.jsx(b,{variant:"outline",className:"text-emerald-400",children:"Multi-Channel Alerts"})]})}),e.jsx("div",{className:"p-6",children:e.jsx(ce,{feature:"multiChannelAlerts",children:e.jsx(V.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(de,{})})})})]})]})})}export{Se as default};
//# sourceMappingURL=advanced-alerts-BY8g604q.js.map
