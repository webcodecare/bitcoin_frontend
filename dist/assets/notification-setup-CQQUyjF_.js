import{j as e}from"./ui-vendor-mfLK6kkQ.js";import{r as c}from"./react-vendor--0RGCJ5T.js";import{b as J,d as F,e as w,g as r,Q as P,j as o,n as d,k as m,o as h,p as u,B as A,w as E,I as t,J as l,D as Z,E as X,F as ee,G as se,H as ae,K as te,O as ie,ad as D,f as C,aq as M}from"./index-DMUxz8dE.js";import{S as j}from"./switch-6PBAG7U5.js";import{T as ne,a as le,b as p,c as f}from"./tabs-CFs29E2A.js";import{S as ce}from"./Sidebar-CWwWAgFd.js";import{H as re}from"./Header-CZNG9THd.js";import{T as oe}from"./test-tube-XhA9jODQ.js";import{S as de}from"./server-O5hvHHC7.js";import{S as me}from"./send-y-4Jk6HA.js";import{S as xe}from"./save-BnNngDY3.js";import{G as he}from"./globe-CBooLoLC.js";import{M as I}from"./message-square-DEryHNXU.js";import{S as ue}from"./smartphone-BAgSRykf.js";import{C as ge}from"./circle-check-big-DJe8srSt.js";import"./chart-vendor-CJvGuOij.js";import"./index-BBVDPgwe.js";import"./activity-Dkd0t9nU.js";import"./dollar-sign-BsbVyGJM.js";import"./file-text-CVGYDGjh.js";import"./NotificationCenter-CPdR7ta7.js";import"./index-BdQq_4o_.js";import"./volume-2-Cn_3p6P5.js";import"./info-KqEO34od.js";function Oe(){const[L,q]=c.useState("channels"),[g,N]=c.useState(null);c.useState(null);const[B,x]=c.useState(!1);c.useState(!1);const[S,z]=c.useState(""),[i,n]=c.useState({type:"email",name:"",isEnabled:!0,configuration:{}});c.useState({name:"",type:"signal_alert",subject:"",content:"",isActive:!0,channels:[]});const{toast:v}=J(),{data:H=[],isLoading:O}=F({queryKey:["/api/admin/notification-channels"]}),{data:Q=[],isLoading:R}=F({queryKey:["/api/admin/notification-templates"]}),y=w({mutationFn:async s=>(await C("POST","/api/admin/notification-channels",s)).json(),onSuccess:()=>{M.invalidateQueries({queryKey:["/api/admin/notification-channels"]}),x(!1),k(),v({title:"Channel Created",description:"Notification channel has been created successfully."})}}),b=w({mutationFn:async({id:s,data:a})=>(await C("PUT",`/api/admin/notification-channels/${s}`,a)).json(),onSuccess:()=>{M.invalidateQueries({queryKey:["/api/admin/notification-channels"]}),x(!1),N(null),v({title:"Channel Updated",description:"Notification channel has been updated successfully."})}}),T=w({mutationFn:async({channelId:s,message:a})=>(await C("POST",`/api/admin/notification-channels/${s}/test`,{message:a})).json(),onSuccess:()=>{v({title:"Test Sent",description:"Test notification has been sent successfully."})}}),k=()=>{n({type:"email",name:"",isEnabled:!0,configuration:{}})},U=()=>{k(),N(null),x(!0)},G=s=>{N(s),n({type:s.type,name:s.name,isEnabled:s.isEnabled,configuration:s.configuration}),x(!0)},K=()=>{g?b.mutate({id:g.id,data:i}):y.mutate(i)},V=s=>{T.mutate({channelId:s,message:S||"Test notification from Proud Profits admin panel"})},_=s=>{switch(s){case"email":return e.jsx(ie,{className:"h-4 w-4 text-blue-500"});case"sms":return e.jsx(ue,{className:"h-4 w-4 text-green-500"});case"telegram":return e.jsx(I,{className:"h-4 w-4 text-blue-400"});case"discord":return e.jsx(I,{className:"h-4 w-4 text-purple-500"});case"webhook":return e.jsx(he,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(E,{className:"h-4 w-4"})}},W=s=>{switch(s){case"active":return e.jsx(ge,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(D,{className:"h-4 w-4 text-red-500"});default:return e.jsx(D,{className:"h-4 w-4 text-gray-400"})}},Y=()=>{switch(i.type){case"email":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"smtp-host",children:"SMTP Host"}),e.jsx(l,{id:"smtp-host",value:i.configuration.host||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,host:s.target.value}})),placeholder:"smtp.gmail.com",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"smtp-port",children:"SMTP Port"}),e.jsx(l,{id:"smtp-port",type:"number",value:i.configuration.port||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,port:s.target.value}})),placeholder:"587",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"smtp-user",children:"Username"}),e.jsx(l,{id:"smtp-user",value:i.configuration.user||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,user:s.target.value}})),placeholder:"your-email@gmail.com",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"smtp-pass",children:"Password"}),e.jsx(l,{id:"smtp-pass",type:"password",value:i.configuration.pass||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,pass:s.target.value}})),placeholder:"App Password",className:"text-sm"})]})]})]});case"sms":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"twilio-sid",children:"Twilio Account SID"}),e.jsx(l,{id:"twilio-sid",value:i.configuration.accountSid||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,accountSid:s.target.value}})),placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"twilio-token",children:"Auth Token"}),e.jsx(l,{id:"twilio-token",type:"password",value:i.configuration.authToken||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,authToken:s.target.value}})),placeholder:"Your Auth Token",className:"text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"twilio-phone",children:"From Phone Number"}),e.jsx(l,{id:"twilio-phone",value:i.configuration.fromPhone||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,fromPhone:s.target.value}})),placeholder:"+1234567890",className:"text-sm"})]})]});case"telegram":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"telegram-token",children:"Bot Token"}),e.jsx(l,{id:"telegram-token",type:"password",value:i.configuration.botToken||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,botToken:s.target.value}})),placeholder:"123456789:ABCdefGHIjklMNOpqrSTUvwxYZ",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"telegram-chat",children:"Default Chat ID"}),e.jsx(l,{id:"telegram-chat",value:i.configuration.chatId||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,chatId:s.target.value}})),placeholder:"-1001234567890",className:"text-sm"})]})]});case"webhook":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"webhook-url",children:"Webhook URL"}),e.jsx(l,{id:"webhook-url",value:i.configuration.url||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,url:s.target.value}})),placeholder:"https://hooks.slack.com/services/...",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"webhook-secret",children:"Secret (optional)"}),e.jsx(l,{id:"webhook-secret",type:"password",value:i.configuration.secret||"",onChange:s=>n(a=>({...a,configuration:{...a.configuration,secret:s.target.value}})),placeholder:"Webhook secret",className:"text-sm"})]})]});default:return null}};return e.jsxs("div",{className:"flex h-screen bg-background",children:[e.jsx(ce,{className:"hidden md:flex"}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden ml-0 md:ml-64",children:[e.jsx(re,{title:"Notification Setup",subtitle:"Configure notification channels and message templates"}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{value:L,onValueChange:q,className:"space-y-4",children:[e.jsxs(le,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[e.jsx(p,{value:"channels",className:"text-xs sm:text-sm",children:"Channels"}),e.jsx(p,{value:"templates",className:"text-xs sm:text-sm",children:"Templates"}),e.jsx(p,{value:"settings",className:"text-xs sm:text-sm",children:"Settings"}),e.jsx(p,{value:"logs",className:"text-xs sm:text-sm",children:"Logs"})]}),e.jsxs(f,{value:"channels",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Notification Channels"}),e.jsxs(r,{onClick:U,className:"w-full sm:w-auto",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Add Channel"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:O?Array.from({length:6}).map((s,a)=>e.jsxs(o,{className:"animate-pulse",children:[e.jsxs(d,{children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),e.jsx(m,{children:e.jsx("div",{className:"h-20 bg-gray-200 rounded"})})]},a)):H.map(s=>e.jsxs(o,{className:s.isEnabled?"":"opacity-60",children:[e.jsx(d,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[_(s.type),e.jsxs("div",{children:[e.jsx(h,{className:"text-base sm:text-lg",children:s.name}),e.jsxs(u,{className:"capitalize text-xs sm:text-sm",children:[s.type," channel"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[W(s.status),e.jsx(A,{variant:s.isEnabled?"default":"secondary",className:"text-xs",children:s.isEnabled?"Enabled":"Disabled"})]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last tested: ",s.lastTested?new Date(s.lastTested).toLocaleDateString():"Never"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>G(s),className:"flex-1 text-xs",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Configure"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>V(s.id),disabled:T.isPending,className:"flex-1 text-xs",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Test"]})]})]})})]},s.id))})]}),e.jsxs(f,{value:"templates",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Message Templates"}),e.jsxs(r,{className:"w-full sm:w-auto",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Add Template"]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:R?Array.from({length:4}).map((s,a)=>e.jsxs(o,{className:"animate-pulse",children:[e.jsxs(d,{children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),e.jsx(m,{children:e.jsx("div",{className:"h-16 bg-gray-200 rounded"})})]},a)):Q.map(s=>e.jsxs(o,{className:s.isActive?"":"opacity-60",children:[e.jsx(d,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-base sm:text-lg",children:s.name}),e.jsx(u,{className:"capitalize text-xs sm:text-sm",children:s.type.replace("_"," ")})]}),e.jsx(A,{variant:s.isActive?"default":"secondary",className:"text-xs",children:s.isActive?"Active":"Inactive"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[s.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Subject:"}),e.jsx("p",{className:"text-xs sm:text-sm line-clamp-1",children:s.subject})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Content Preview:"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2",children:s.content})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Channels: ",s.channels.length]})]})})]},s.id))})]}),e.jsx(f,{value:"settings",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(h,{className:"text-base sm:text-lg",children:"Global Notification Settings"}),e.jsx(u,{className:"text-xs sm:text-sm",children:"Configure system-wide notification preferences"})]}),e.jsx(m,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-sm font-medium",children:"Enable Notifications"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Master switch for all notifications"})]}),e.jsx(j,{})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-sm font-medium",children:"Rate Limiting"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Prevent notification spam"})]}),e.jsx(j,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-sm font-medium",children:"Queue Processing"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Process notifications in background"})]}),e.jsx(j,{defaultChecked:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"retry-attempts",className:"text-sm",children:"Retry Attempts"}),e.jsx(l,{id:"retry-attempts",type:"number",defaultValue:"3",min:"1",max:"10",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"batch-size",className:"text-sm",children:"Batch Size"}),e.jsx(l,{id:"batch-size",type:"number",defaultValue:"50",min:"1",max:"500",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"queue-interval",className:"text-sm",children:"Queue Interval (seconds)"}),e.jsx(l,{id:"queue-interval",type:"number",defaultValue:"30",min:"5",max:"300",className:"text-sm"})]})]})]})})]})}),e.jsx(f,{value:"logs",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(h,{className:"text-base sm:text-lg",children:"Notification Logs"}),e.jsx(u,{className:"text-xs sm:text-sm",children:"Recent notification delivery history"})]}),e.jsx(m,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(de,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notification logs will appear here once the system is active."})]})})]})})]}),e.jsxs(o,{className:"mt-6",children:[e.jsxs(d,{children:[e.jsx(h,{className:"text-base sm:text-lg",children:"Test Message"}),e.jsx(u,{className:"text-xs sm:text-sm",children:"Enter a custom message for testing notification channels"})]}),e.jsx(m,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx(l,{value:S,onChange:s=>z(s.target.value),placeholder:"Enter test message...",className:"flex-1 text-sm"}),e.jsxs(r,{variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Send Test"]})]})})]}),e.jsx(Z,{open:B,onOpenChange:x,children:e.jsxs(X,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ee,{children:[e.jsx(se,{children:g?"Configure Channel":"Add Notification Channel"}),e.jsx(ae,{children:g?"Update notification channel settings":"Set up a new notification channel"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"channel-name",children:"Channel Name"}),e.jsx(l,{id:"channel-name",value:i.name,onChange:s=>n(a=>({...a,name:s.target.value})),placeholder:"My Email Channel",className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"channel-type",children:"Channel Type"}),e.jsxs("select",{id:"channel-type",value:i.type,onChange:s=>n(a=>({...a,type:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"sms",children:"SMS"}),e.jsx("option",{value:"telegram",children:"Telegram"}),e.jsx("option",{value:"discord",children:"Discord"}),e.jsx("option",{value:"webhook",children:"Webhook"})]})]})]}),Y(),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{checked:i.isEnabled,onCheckedChange:s=>n(a=>({...a,isEnabled:s}))}),e.jsx(t,{className:"text-sm",children:"Enable this channel"})]})]}),e.jsxs(te,{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(r,{variant:"outline",onClick:()=>x(!1),className:"w-full sm:w-auto",children:"Cancel"}),e.jsxs(r,{onClick:K,disabled:y.isPending||b.isPending,className:"w-full sm:w-auto",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),y.isPending||b.isPending?"Saving...":"Save Channel"]})]})]})})]})})]})]})}export{Oe as default};
//# sourceMappingURL=notification-setup-CQQUyjF_.js.map
