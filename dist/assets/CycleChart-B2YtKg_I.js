import{j as t}from"./ui-vendor-mfLK6kkQ.js";import{r as T}from"./react-vendor--0RGCJ5T.js";import{d as P,j as D,n as k,o as C,p as S,k as E,B as q,T as K,s as O}from"./index-DMUxz8dE.js";import{A as M}from"./activity-Dkd0t9nU.js";import"./chart-vendor-CJvGuOij.js";function J({symbol:y="BTC",height:d=300,className:j}){const h=T.useRef(null),{data:c,isLoading:L}=P({queryKey:[`/api/public/chart/cycle/${y}`],refetchInterval:6e4}),{data:W}=P({queryKey:[`/api/public/chart/forecast/${y}`],refetchInterval:6e4});if(T.useEffect(()=>{if(!h.current)return;h.current.innerHTML="";const i=document.createElement("canvas"),e=i.getContext("2d");if(!e)return;i.width=h.current.clientWidth||600,i.height=d,i.style.width="100%",i.style.height=`${d}px`,h.current.appendChild(i);const a=40,b=i.width-a*2,r=i.height-a*2,p=730,H=b/p,I=()=>{const s=[],n=[],f=[];for(let l=0;l<p;l++){const m=a+l*H;if(c&&c.length>0){const w=Math.floor(l/p*c.length),g=c[w];s.push({x:m,y:a+r-parseFloat(g.ma2y)/8e4*r}),n.push({x:m,y:a+r-(parseFloat(g.deviation)+1)*r/2})}else{const g=35e3+Math.sin(l*.008)*25e3+Math.sin(l*.002)*5e3,Y=Math.sin(l*.01)*.5+Math.random()*.1;s.push({x:m,y:a+r-g/8e4*r}),n.push({x:m,y:a+r-(Y+1)*r/2})}l%1460===0&&l>0&&f.push({x:m,label:`Halving ${Math.floor(l/1460)}`})}return{ma2yData:s,deviationData:n,halvingEvents:f}},{ma2yData:B,deviationData:u,halvingEvents:R}=I();e.strokeStyle="hsl(var(--border))",e.lineWidth=1;for(let s=0;s<=5;s++){const n=a+s/5*r;e.beginPath(),e.moveTo(a,n),e.lineTo(i.width-a,n),e.stroke()}e.strokeStyle="#3b82f6",e.lineWidth=2,e.beginPath(),B.forEach((s,n)=>{n===0?e.moveTo(s.x,s.y):e.lineTo(s.x,s.y)}),e.stroke(),e.fillStyle="rgba(34, 197, 94, 0.2)",e.beginPath(),u.forEach((s,n)=>{n===0?e.moveTo(s.x,s.y):e.lineTo(s.x,s.y)}),e.lineTo(u[u.length-1].x,a+r),e.lineTo(a,a+r),e.closePath(),e.fill(),e.strokeStyle="#22c55e",e.lineWidth=2,e.beginPath(),u.forEach((s,n)=>{n===0?e.moveTo(s.x,s.y):e.lineTo(s.x,s.y)}),e.stroke(),R.forEach(s=>{e.strokeStyle="#f97316",e.lineWidth=2,e.setLineDash([5,5]),e.beginPath(),e.moveTo(s.x,a),e.lineTo(s.x,a+r),e.stroke(),e.setLineDash([]),e.fillStyle="#f97316",e.beginPath(),e.arc(s.x,a+20,6,0,2*Math.PI),e.fill(),e.fillStyle="hsl(var(--foreground))",e.font="10px system-ui",e.textAlign="center",e.fillText(s.label,s.x,a+10)}),e.fillStyle="hsl(var(--muted-foreground))",e.font="12px system-ui",e.textAlign="right";for(let s=0;s<=5;s++){const n=a+s/5*r,f=(1-s/5)*2-1;e.fillText(f.toFixed(1),a-5,n+4)}const N=a+b*.9;e.strokeStyle="#dc2626",e.lineWidth=2,e.setLineDash([3,3]),e.beginPath(),e.moveTo(N,a),e.lineTo(N,a+r),e.stroke(),e.setLineDash([])},[c,W,y,d]),L)return t.jsxs(D,{className:j,children:[t.jsxs(k,{children:[t.jsxs(C,{className:"flex items-center",children:[t.jsx(M,{className:"mr-2 h-5 w-5"}),"2-Year Cycle Analysis"]}),t.jsx(S,{children:"Loading cycle data..."})]}),t.jsx(E,{children:t.jsx("div",{className:"flex items-center justify-center",style:{height:`${d}px`},children:t.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})})]});const o=c&&c.length>0?c[0]:null,v=(o==null?void 0:o.cyclePhase)||"accumulation",x=o?parseFloat(o.deviation):.15,A=o?parseFloat(o.strengthScore):.78,F=i=>{switch(i){case"accumulation":return"bg-blue-500";case"markup":return"bg-green-500";case"distribution":return"bg-orange-500";case"markdown":return"bg-red-500";default:return"bg-gray-500"}},$=i=>{switch(i){case"accumulation":return"Smart money accumulating, prices stable";case"markup":return"Uptrend in progress, momentum building";case"distribution":return"Late stage bull, smart money selling";case"markdown":return"Downtrend active, bear market";default:return"Cycle phase undefined"}};return t.jsxs(D,{className:j,children:[t.jsx(k,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs(C,{className:"flex items-center",children:[t.jsx(M,{className:"mr-2 h-5 w-5"}),"2-Year Cycle Analysis"]}),t.jsx(S,{children:"Price deviation from 2-year moving average with market cycles"})]}),t.jsxs("div",{className:"text-right",children:[t.jsx(q,{className:F(v),children:v}),t.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["Strength: ",(A*100).toFixed(0),"%"]})]})]})}),t.jsxs(E,{children:[t.jsx("div",{ref:h,className:"w-full",style:{height:`${d}px`}}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),t.jsx("span",{children:"2-Year MA"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-3 h-3 bg-green-400 rounded"}),t.jsx("span",{children:"Price Deviation"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-3 h-3 bg-orange-400 rounded-full"}),t.jsx("span",{children:"Halving Events"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[x>0?t.jsx(K,{className:"w-4 h-4 text-green-500"}):t.jsx(O,{className:"w-4 h-4 text-red-500"}),t.jsxs("span",{className:"font-medium",children:[x>0?"+":"",(x*100).toFixed(1),"%"]})]})]}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Current Phase:"})," ",$(v)]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Signal:"})," ",x>.5?"Overbought - Consider taking profits":x<-.3?"Oversold - Potential accumulation zone":"Neutral - Watch for trend continuation"]})]})]})]})]})}export{J as default};
//# sourceMappingURL=CycleChart-B2YtKg_I.js.map
